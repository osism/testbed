---
_network_vxlan_interfaces:
  vxlan0:
    vni: 42
    local_ip: "{{ [inventory_hostname] | map('extract', hostvars, 'ansible_facts') | map(attribute=internal_interface) | map(attribute='ipv4') | map(attribute='address') | first }}"
    group: 239.1.1.1
    addresses: >-
      {{
        [
          '192.168.112.0/20' | ansible.utils.ipaddr('net')
                             | ansible.utils.ipaddr(node_id)
                             | ansible.utils.ipaddr('address')
          + '/20'
        ] if inventory_hostname in groups['testbed-managers'] else []
      }}
  vxlan1:
    vni: 23
    local_ip: "{{ [inventory_hostname] | map('extract', hostvars, 'ansible_facts') | map(attribute=internal_interface) | map(attribute='ipv4') | map(attribute='address') | first }}"
    group: 239.1.1.1
    addresses:
      - "{{ '192.168.128.0/20' | ansible.utils.ipaddr('net') | ansible.utils.ipaddr(node_id) | ansible.utils.ipaddr('address') }}/20"
