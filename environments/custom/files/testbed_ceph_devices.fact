#!/usr/bin/env python3

import json
import os
from subprocess import PIPE, run

import requests

response = requests.get('http://169.254.169.254/latest/meta-data/block-device-mapping/root')
root = os.path.basename(response.text)

devices = run("lsblk -nd -I 8,220,252 --output NAME | sort | grep -v %s" % root, stdout=PIPE, stderr=PIPE, universal_newlines=True, shell=True)
result = devices.stdout.strip().split("\n")

print(json.dumps(["/dev/%s" % x for x in result[:-1]]))
